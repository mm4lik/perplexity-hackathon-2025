<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Deception Detection Module</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f9fafb; margin: 0; padding: 40px 20px; display: flex; flex-direction: column; align-items: center; min-height: 100vh; color: #333; }
    h1 { margin-bottom: 30px; font-weight: 700; color: #2c3e50; font-size: 2.2rem; text-align: center; }
    form#deceptionForm { width: 100%; max-width: 700px; display: flex; flex-direction: column; gap: 15px; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 3px 12px rgba(0,0,0,0.1);}
    textarea#textInput { min-height: 150px; font-size: 1.1rem; padding: 15px; border-radius: 8px; border: 1.5px solid #ccc; font-family: monospace; resize: vertical; transition: border-color 0.2s ease;}
    textarea#textInput:focus { outline: none; border-color: #e67e22; box-shadow: 0 0 8px rgba(230, 126, 34, 0.3);}
    button[type="submit"] { background-color: #e67e22; color: white; font-weight: 600; font-size: 1.1rem; padding: 14px; border: none; border-radius: 8px; cursor: pointer; transition: background-color 0.3s ease;}
    button[type="submit"]:hover { background-color: #ca6f1e;}
    #result { max-width: 700px; margin-top: 30px; background: #f0f4f8; padding: 28px 24px; border-radius: 10px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; color: #34495e; box-shadow: inset 0 0 6px rgba(0,0,0,0.08);}
    .risk-bar { width: 100%; height: 32px; border-radius: 8px; margin-bottom: 18px; background: #e0e0e0; position: relative; overflow: hidden;}
    .risk-bar-inner { height: 100%; border-radius: 8px; transition: width 0.6s; color: #fff; font-weight: bold; display: flex; align-items: center; justify-content: center; font-size: 1.1rem; letter-spacing: 1px;}
    .risk-bar.red { background: #e74c3c; }
    .risk-bar.orange { background: #f39c12; }
    .risk-bar.yellow { background: #f1c40f; color: #333; }
    .risk-bar.green { background: #2ecc40; }
    .risk-label { font-weight: bold; font-size: 1.2rem; margin-bottom: 10px; text-align: center;}
    .section-title { font-weight: bold; margin-top: 20px; margin-bottom: 8px; font-size: 1.1rem; color: #222;}
    .list { margin: 0 0 8px 0; padding-left: 18px;}
    .list li { margin-bottom: 7px; font-size: 1.05rem;}
    .body-summary { background: #f9f9f9; border-radius: 6px; padding: 10px 12px; margin-bottom: 10px; font-size: 1.07rem;}
    .risk-score { font-size: 1.3rem; font-weight: bold; }
    @media (max-width: 700px) { #result, form#deceptionForm { max-width: 100%; } }
  </style>
</head>
<body>
  <h1>Deception Detection Module</h1>
  <form id="deceptionForm">
    <textarea name="text" id="textInput" placeholder="Paste text or email here for deception analysis..."></textarea>
    <button type="submit">Analyze</button>
  </form>
  <div id="result"></div>
  <script>
    document.getElementById('deceptionForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const text = document.getElementById('textInput').value.trim();
      if (!text) {
        document.getElementById('result').innerText = 'Please enter some text to analyze.';
        return;
      }
      document.getElementById('result').innerHTML = '<b>Analyzing... (this may take a few seconds for advanced checks)</b>';
      const response = await fetch('/deception-detection', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ text })
      });
      if (!response.ok) {
        const error = await response.json();
        document.getElementById('result').innerText = 'Error: ' + error.error;
        return;
      }
      const data = await response.json();
      // Risk color mapping
      let riskBarClass = "gray";
      let score = data.risk_score || 0;
      if (score >= 75) riskBarClass = "red";
      else if (score >= 50) riskBarClass = "orange";
      else if (score >= 25) riskBarClass = "yellow";
      else riskBarClass = "green";
      let riskLabel = "";
      if (score >= 75) riskLabel = "Critical Risk";
      else if (score >= 50) riskLabel = "Moderate-High Risk";
      else if (score >= 25) riskLabel = "Moderate Risk";
      else riskLabel = "Low Risk";
      let html = `
        <div class="risk-label">
          ü§• <span class="risk-score">Deception Risk Score: ${score}% ‚Äì ${riskLabel}</span>
        </div>
        <div class="risk-bar ${riskBarClass}">
          <div class="risk-bar-inner" style="width:${score}%;">
            ${score}%
          </div>
        </div>
        <div class="section-title">üîç Deceptive Cues Detected:</div>
        <ul class="list">
          ${(data.cues || []).map(e => `<li>${e}</li>`).join('') || '<li>No strong cues detected.</li>'}
        </ul>
        <div class="section-title">Summary:</div>
        <div class="body-summary">${data.summary || ''}</div>
      `;
      document.getElementById('result').innerHTML = html;
    });
  </script>
</body>
</html>
